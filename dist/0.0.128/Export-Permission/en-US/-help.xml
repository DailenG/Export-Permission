<?xml version="1.0" encoding="utf-8"?>
<helpItems schema="maml" xmlns="http://msh">
  <command:command xmlns:maml="http://schemas.microsoft.com/maml/2004/10" xmlns:command="http://schemas.microsoft.com/maml/dev/command/2004/10" xmlns:dev="http://schemas.microsoft.com/maml/dev/2004/10" xmlns:MSHelp="http://msdn.microsoft.com/mshelp">
    <command:details>
      <command:name>Export-Permission.ps1</command:name>
      <command:verb>Export</command:verb>
      <command:noun>Permission.ps1</command:noun>
      <maml:description>
        <maml:para>Create CSV, HTML, and XML reports of permissions</maml:para>
      </maml:description>
    </command:details>
    <maml:description>
      <maml:para>Benefits: - Presents complex nested permissions and group memberships in a report that is easy to read</maml:para>
      <maml:para>- Provides additional information about each user such as Name, Department, Title</maml:para>
      <maml:para>- Multithreaded with caching for fast results</maml:para>
      <maml:para>- Works as a scheduled task</maml:para>
      <maml:para>- Works as a custom sensor script for Paessler PRTG Network Monitor (Push sensor recommended due to execution time)</maml:para>
      <maml:para></maml:para>
      <maml:para>Supports these scenarios: - local folder paths (resolved to UNC paths using the administrative shares, so the computer name is shown in the reports)</maml:para>
      <maml:para>- UNC folder paths</maml:para>
      <maml:para>- DFS folder paths (resolves them to their UNC folder targets, and reports permissions on each folder target)</maml:para>
      <maml:para>- Active Directory domain trusts, and unresolved SIDs for deleted accounts</maml:para>
      <maml:para></maml:para>
      <maml:para>Does not support these scenarios: - File permissions (only folder permissions are reported)</maml:para>
      <maml:para>- Share permissions (only NTFS permissions are reported)</maml:para>
      <maml:para>- Mapped network drives (TODO feature, for now use UNC paths)</maml:para>
      <maml:para>- ACL Owners or Groups (TODO feature, for now only the DACL is reported)</maml:para>
      <maml:para></maml:para>
      <maml:para>Behavior: - Gets all permissions for the target folder</maml:para>
      <maml:para>- Gets non-inherited permissions for subfolders (if specified)</maml:para>
      <maml:para>- Exports the permissions to a .csv file</maml:para>
      <maml:para>- Uses ADSI to get information about the accounts and groups listed in the permissions</maml:para>
      <maml:para>- Exports information about the accounts and groups to a .csv file</maml:para>
      <maml:para>- Uses ADSI to recursively retrieve group members</maml:para>
      <maml:para>    - The entire chain of group memberships is not retrieved (for performance reasons)     - This means nested group members are retrieved, but nested groups themselves are not - Exports information about all accounts with access to a .csv file</maml:para>
      <maml:para>- Exports information about all accounts with access to a report generated as a .html file</maml:para>
      <maml:para>- Outputs an XML-formatted list of common misconfigurations for use in Paessler PRTG Network Monitor as a custom XML sensor</maml:para>
    </maml:description>
    <command:syntax>
      <command:syntaxItem>
        <maml:name>Export-Permission.ps1</maml:name>
        <command:parameter required="false" variableLength="true" globbing="false" pipelineInput="True (ByValue)" position="1" aliases="none">
          <maml:name>TargetPath</maml:name>
          <maml:description>
            <maml:para>Path to the NTFS folder whose permissions to export</maml:para>
          </maml:description>
          <command:parameterValue required="true" variableLength="false">System.IO.DirectoryInfo[]</command:parameterValue>
          <dev:type>
            <maml:name>System.IO.DirectoryInfo[]</maml:name>
            <maml:uri />
          </dev:type>
          <dev:defaultValue>C:\Test</dev:defaultValue>
        </command:parameter>
        <command:parameter required="false" variableLength="true" globbing="false" pipelineInput="False" position="10" aliases="none">
          <maml:name>PrtgSensorProtocol</maml:name>
          <maml:description>
            <maml:para>If all four of the PRTG parameters are specified,</maml:para>
            <maml:para>the results will be XML-formatted and pushed to the specified PRTG probe for a push sensor</maml:para>
          </maml:description>
          <command:parameterValue required="true" variableLength="false">System.String</command:parameterValue>
          <dev:type>
            <maml:name>System.String</maml:name>
            <maml:uri />
          </dev:type>
          <dev:defaultValue>None</dev:defaultValue>
        </command:parameter>
        <command:parameter required="false" variableLength="true" globbing="false" pipelineInput="False" position="11" aliases="none">
          <maml:name>PrtgSensorPort</maml:name>
          <maml:description>
            <maml:para>If all four of the PRTG parameters are specified,</maml:para>
            <maml:para>the results will be XML-formatted and pushed to the specified PRTG probe for a push sensor</maml:para>
          </maml:description>
          <command:parameterValue required="true" variableLength="false">System.UInt32</command:parameterValue>
          <dev:type>
            <maml:name>System.UInt32</maml:name>
            <maml:uri />
          </dev:type>
          <dev:defaultValue>0</dev:defaultValue>
        </command:parameter>
        <command:parameter required="false" variableLength="true" globbing="false" pipelineInput="False" position="12" aliases="none">
          <maml:name>PrtgSensorToken</maml:name>
          <maml:description>
            <maml:para>If all four of the PRTG parameters are specified,</maml:para>
            <maml:para>the results will be XML-formatted and pushed to the specified PRTG probe for a push sensor</maml:para>
          </maml:description>
          <command:parameterValue required="true" variableLength="false">System.String</command:parameterValue>
          <dev:type>
            <maml:name>System.String</maml:name>
            <maml:uri />
          </dev:type>
          <dev:defaultValue>None</dev:defaultValue>
        </command:parameter>
        <command:parameter required="false" variableLength="true" globbing="false" pipelineInput="False" position="2" aliases="none">
          <maml:name>ExcludeAccount</maml:name>
          <maml:description>
            <maml:para>Regular expressions matching names of security principals to exclude from the HTML report</maml:para>
          </maml:description>
          <command:parameterValue required="true" variableLength="false">System.String[]</command:parameterValue>
          <dev:type>
            <maml:name>System.String[]</maml:name>
            <maml:uri />
          </dev:type>
          <dev:defaultValue>None</dev:defaultValue>
        </command:parameter>
        <command:parameter required="false" variableLength="true" globbing="false" pipelineInput="False" position="3" aliases="none">
          <maml:name>IgnoreDomain</maml:name>
          <maml:description>
            <maml:para>Domains to ignore (they will be removed from the username)</maml:para>
            <maml:para>Intended when a user has matching SamAccountNames in multiple domains but you only want them to appear once on the report.</maml:para>
          </maml:description>
          <command:parameterValue required="true" variableLength="false">System.String[]</command:parameterValue>
          <dev:type>
            <maml:name>System.String[]</maml:name>
            <maml:uri />
          </dev:type>
          <dev:defaultValue>None</dev:defaultValue>
        </command:parameter>
        <command:parameter required="false" variableLength="true" globbing="false" pipelineInput="False" position="4" aliases="none">
          <maml:name>LogDir</maml:name>
          <maml:description>
            <maml:para>Path to the folder to save the logs and reports generated by this script</maml:para>
          </maml:description>
          <command:parameterValue required="true" variableLength="false">System.String</command:parameterValue>
          <dev:type>
            <maml:name>System.String</maml:name>
            <maml:uri />
          </dev:type>
          <dev:defaultValue>"$env:AppData\Export-Permission\Logs"</dev:defaultValue>
        </command:parameter>
        <command:parameter required="false" variableLength="true" globbing="false" pipelineInput="False" position="5" aliases="none">
          <maml:name>SubfolderLevels</maml:name>
          <maml:description>
            <maml:para>How many levels of subfolder to enumerate</maml:para>
            <maml:para>    Set to 0 to ignore all subfolders</maml:para>
            <maml:para>    Set to -1 (default) to recurse infinitely</maml:para>
            <maml:para>    Set to any whole number to enumerate that many levels</maml:para>
          </maml:description>
          <command:parameterValue required="true" variableLength="false">System.Int32</command:parameterValue>
          <dev:type>
            <maml:name>System.Int32</maml:name>
            <maml:uri />
          </dev:type>
          <dev:defaultValue>-1</dev:defaultValue>
        </command:parameter>
        <command:parameter required="false" variableLength="true" globbing="false" pipelineInput="False" position="6" aliases="none">
          <maml:name>Title</maml:name>
          <maml:description>
            <maml:para>Title at the top of the HTML report</maml:para>
          </maml:description>
          <command:parameterValue required="true" variableLength="false">System.String</command:parameterValue>
          <dev:type>
            <maml:name>System.String</maml:name>
            <maml:uri />
          </dev:type>
          <dev:defaultValue>Permissions Report</dev:defaultValue>
        </command:parameter>
        <command:parameter required="false" variableLength="true" globbing="false" pipelineInput="False" position="7" aliases="none">
          <maml:name>GroupNamingConvention</maml:name>
          <maml:description>
            <maml:para>Valid group names that are allowed to appear in ACEs</maml:para>
            <maml:para>Specify as a ScriptBlock meant for the FilterScript parameter of Where-Object</maml:para>
            <maml:para>In the scriptblock, use string comparisons on the Name property</maml:para>
            <maml:para>e.g. {$ .Name -like 'CONTOSO\Group1*' -or $ .Name -eq 'CONTOSO\Group23'}</maml:para>
            <maml:para>The naming format that will be used for the groups is CONTOSO\Group1</maml:para>
            <maml:para>where CONTOSO is the NetBIOS name of the domain, and Group1 is the samAccountName of the group</maml:para>
            <maml:para>By default, this is a scriptblock that always evaluates to $true so it doesn't evaluate any naming convention compliance</maml:para>
          </maml:description>
          <command:parameterValue required="true" variableLength="false">System.Management.Automation.ScriptBlock</command:parameterValue>
          <dev:type>
            <maml:name>System.Management.Automation.ScriptBlock</maml:name>
            <maml:uri />
          </dev:type>
          <dev:defaultValue>{ $true }</dev:defaultValue>
        </command:parameter>
        <command:parameter required="false" variableLength="true" globbing="false" pipelineInput="False" position="8" aliases="none">
          <maml:name>ThreadCount</maml:name>
          <maml:description>
            <maml:para>Number of asynchronous threads to use</maml:para>
          </maml:description>
          <command:parameterValue required="true" variableLength="false">System.UInt32</command:parameterValue>
          <dev:type>
            <maml:name>System.UInt32</maml:name>
            <maml:uri />
          </dev:type>
          <dev:defaultValue>4</dev:defaultValue>
        </command:parameter>
        <command:parameter required="false" variableLength="true" globbing="false" pipelineInput="False" position="9" aliases="none">
          <maml:name>PrtgProbe</maml:name>
          <maml:description>
            <maml:para>If all four of the PRTG parameters are specified,</maml:para>
            <maml:para>the results will be XML-formatted and pushed to the specified PRTG probe for a push sensor</maml:para>
          </maml:description>
          <command:parameterValue required="true" variableLength="false">System.String</command:parameterValue>
          <dev:type>
            <maml:name>System.String</maml:name>
            <maml:uri />
          </dev:type>
          <dev:defaultValue>None</dev:defaultValue>
        </command:parameter>
        <command:parameter required="false" variableLength="true" globbing="false" pipelineInput="False" position="named" aliases="none">
          <maml:name>ExcludeEmptyGroups</maml:name>
          <maml:description>
            <maml:para>Exclude empty groups from the HTML report</maml:para>
          </maml:description>
          <dev:type>
            <maml:name>System.Management.Automation.SwitchParameter</maml:name>
            <maml:uri />
          </dev:type>
          <dev:defaultValue>False</dev:defaultValue>
        </command:parameter>
        <command:parameter required="false" variableLength="true" globbing="false" pipelineInput="False" position="named" aliases="none">
          <maml:name>NoGroupMembers</maml:name>
          <maml:description>
            <maml:para>Do not get group members (only report the groups themselves)</maml:para>
          </maml:description>
          <dev:type>
            <maml:name>System.Management.Automation.SwitchParameter</maml:name>
            <maml:uri />
          </dev:type>
          <dev:defaultValue>False</dev:defaultValue>
        </command:parameter>
        <command:parameter required="false" variableLength="true" globbing="false" pipelineInput="False" position="named" aliases="none">
          <maml:name>OpenReportAtEnd</maml:name>
          <maml:description>
            <maml:para>Open the HTML report after the script is finished using Invoke-Item (only useful interactively)</maml:para>
          </maml:description>
          <dev:type>
            <maml:name>System.Management.Automation.SwitchParameter</maml:name>
            <maml:uri />
          </dev:type>
          <dev:defaultValue>False</dev:defaultValue>
        </command:parameter>
      </command:syntaxItem>
    </command:syntax>
    <command:parameters>
      <command:parameter required="false" variableLength="true" globbing="false" pipelineInput="False" position="2" aliases="none">
        <maml:name>ExcludeAccount</maml:name>
        <maml:description>
          <maml:para>Regular expressions matching names of security principals to exclude from the HTML report</maml:para>
        </maml:description>
        <command:parameterValue required="true" variableLength="false">System.String[]</command:parameterValue>
        <dev:type>
          <maml:name>System.String[]</maml:name>
          <maml:uri />
        </dev:type>
        <dev:defaultValue>None</dev:defaultValue>
      </command:parameter>
      <command:parameter required="false" variableLength="true" globbing="false" pipelineInput="False" position="named" aliases="none">
        <maml:name>ExcludeEmptyGroups</maml:name>
        <maml:description>
          <maml:para>Exclude empty groups from the HTML report</maml:para>
        </maml:description>
        <command:parameterValue required="true" variableLength="false">System.Management.Automation.SwitchParameter</command:parameterValue>
        <dev:type>
          <maml:name>System.Management.Automation.SwitchParameter</maml:name>
          <maml:uri />
        </dev:type>
        <dev:defaultValue>False</dev:defaultValue>
      </command:parameter>
      <command:parameter required="false" variableLength="true" globbing="false" pipelineInput="False" position="7" aliases="none">
        <maml:name>GroupNamingConvention</maml:name>
        <maml:description>
          <maml:para>Valid group names that are allowed to appear in ACEs</maml:para>
          <maml:para>Specify as a ScriptBlock meant for the FilterScript parameter of Where-Object</maml:para>
          <maml:para>In the scriptblock, use string comparisons on the Name property</maml:para>
          <maml:para>e.g. {$ .Name -like 'CONTOSO\Group1*' -or $ .Name -eq 'CONTOSO\Group23'}</maml:para>
          <maml:para>The naming format that will be used for the groups is CONTOSO\Group1</maml:para>
          <maml:para>where CONTOSO is the NetBIOS name of the domain, and Group1 is the samAccountName of the group</maml:para>
          <maml:para>By default, this is a scriptblock that always evaluates to $true so it doesn't evaluate any naming convention compliance</maml:para>
        </maml:description>
        <command:parameterValue required="true" variableLength="false">System.Management.Automation.ScriptBlock</command:parameterValue>
        <dev:type>
          <maml:name>System.Management.Automation.ScriptBlock</maml:name>
          <maml:uri />
        </dev:type>
        <dev:defaultValue>{ $true }</dev:defaultValue>
      </command:parameter>
      <command:parameter required="false" variableLength="true" globbing="false" pipelineInput="False" position="3" aliases="none">
        <maml:name>IgnoreDomain</maml:name>
        <maml:description>
          <maml:para>Domains to ignore (they will be removed from the username)</maml:para>
          <maml:para>Intended when a user has matching SamAccountNames in multiple domains but you only want them to appear once on the report.</maml:para>
        </maml:description>
        <command:parameterValue required="true" variableLength="false">System.String[]</command:parameterValue>
        <dev:type>
          <maml:name>System.String[]</maml:name>
          <maml:uri />
        </dev:type>
        <dev:defaultValue>None</dev:defaultValue>
      </command:parameter>
      <command:parameter required="false" variableLength="true" globbing="false" pipelineInput="False" position="4" aliases="none">
        <maml:name>LogDir</maml:name>
        <maml:description>
          <maml:para>Path to the folder to save the logs and reports generated by this script</maml:para>
        </maml:description>
        <command:parameterValue required="true" variableLength="false">System.String</command:parameterValue>
        <dev:type>
          <maml:name>System.String</maml:name>
          <maml:uri />
        </dev:type>
        <dev:defaultValue>"$env:AppData\Export-Permission\Logs"</dev:defaultValue>
      </command:parameter>
      <command:parameter required="false" variableLength="true" globbing="false" pipelineInput="False" position="named" aliases="none">
        <maml:name>NoGroupMembers</maml:name>
        <maml:description>
          <maml:para>Do not get group members (only report the groups themselves)</maml:para>
        </maml:description>
        <command:parameterValue required="true" variableLength="false">System.Management.Automation.SwitchParameter</command:parameterValue>
        <dev:type>
          <maml:name>System.Management.Automation.SwitchParameter</maml:name>
          <maml:uri />
        </dev:type>
        <dev:defaultValue>False</dev:defaultValue>
      </command:parameter>
      <command:parameter required="false" variableLength="true" globbing="false" pipelineInput="False" position="named" aliases="none">
        <maml:name>OpenReportAtEnd</maml:name>
        <maml:description>
          <maml:para>Open the HTML report after the script is finished using Invoke-Item (only useful interactively)</maml:para>
        </maml:description>
        <command:parameterValue required="true" variableLength="false">System.Management.Automation.SwitchParameter</command:parameterValue>
        <dev:type>
          <maml:name>System.Management.Automation.SwitchParameter</maml:name>
          <maml:uri />
        </dev:type>
        <dev:defaultValue>False</dev:defaultValue>
      </command:parameter>
      <command:parameter required="false" variableLength="true" globbing="false" pipelineInput="False" position="9" aliases="none">
        <maml:name>PrtgProbe</maml:name>
        <maml:description>
          <maml:para>If all four of the PRTG parameters are specified,</maml:para>
          <maml:para>the results will be XML-formatted and pushed to the specified PRTG probe for a push sensor</maml:para>
        </maml:description>
        <command:parameterValue required="true" variableLength="false">System.String</command:parameterValue>
        <dev:type>
          <maml:name>System.String</maml:name>
          <maml:uri />
        </dev:type>
        <dev:defaultValue>None</dev:defaultValue>
      </command:parameter>
      <command:parameter required="false" variableLength="true" globbing="false" pipelineInput="False" position="11" aliases="none">
        <maml:name>PrtgSensorPort</maml:name>
        <maml:description>
          <maml:para>If all four of the PRTG parameters are specified,</maml:para>
          <maml:para>the results will be XML-formatted and pushed to the specified PRTG probe for a push sensor</maml:para>
        </maml:description>
        <command:parameterValue required="true" variableLength="false">System.UInt32</command:parameterValue>
        <dev:type>
          <maml:name>System.UInt32</maml:name>
          <maml:uri />
        </dev:type>
        <dev:defaultValue>0</dev:defaultValue>
      </command:parameter>
      <command:parameter required="false" variableLength="true" globbing="false" pipelineInput="False" position="10" aliases="none">
        <maml:name>PrtgSensorProtocol</maml:name>
        <maml:description>
          <maml:para>If all four of the PRTG parameters are specified,</maml:para>
          <maml:para>the results will be XML-formatted and pushed to the specified PRTG probe for a push sensor</maml:para>
        </maml:description>
        <command:parameterValue required="true" variableLength="false">System.String</command:parameterValue>
        <dev:type>
          <maml:name>System.String</maml:name>
          <maml:uri />
        </dev:type>
        <dev:defaultValue>None</dev:defaultValue>
      </command:parameter>
      <command:parameter required="false" variableLength="true" globbing="false" pipelineInput="False" position="12" aliases="none">
        <maml:name>PrtgSensorToken</maml:name>
        <maml:description>
          <maml:para>If all four of the PRTG parameters are specified,</maml:para>
          <maml:para>the results will be XML-formatted and pushed to the specified PRTG probe for a push sensor</maml:para>
        </maml:description>
        <command:parameterValue required="true" variableLength="false">System.String</command:parameterValue>
        <dev:type>
          <maml:name>System.String</maml:name>
          <maml:uri />
        </dev:type>
        <dev:defaultValue>None</dev:defaultValue>
      </command:parameter>
      <command:parameter required="false" variableLength="true" globbing="false" pipelineInput="False" position="5" aliases="none">
        <maml:name>SubfolderLevels</maml:name>
        <maml:description>
          <maml:para>How many levels of subfolder to enumerate</maml:para>
          <maml:para>    Set to 0 to ignore all subfolders</maml:para>
          <maml:para>    Set to -1 (default) to recurse infinitely</maml:para>
          <maml:para>    Set to any whole number to enumerate that many levels</maml:para>
        </maml:description>
        <command:parameterValue required="true" variableLength="false">System.Int32</command:parameterValue>
        <dev:type>
          <maml:name>System.Int32</maml:name>
          <maml:uri />
        </dev:type>
        <dev:defaultValue>-1</dev:defaultValue>
      </command:parameter>
      <command:parameter required="false" variableLength="true" globbing="false" pipelineInput="True (ByValue)" position="1" aliases="none">
        <maml:name>TargetPath</maml:name>
        <maml:description>
          <maml:para>Path to the NTFS folder whose permissions to export</maml:para>
        </maml:description>
        <command:parameterValue required="true" variableLength="false">System.IO.DirectoryInfo[]</command:parameterValue>
        <dev:type>
          <maml:name>System.IO.DirectoryInfo[]</maml:name>
          <maml:uri />
        </dev:type>
        <dev:defaultValue>C:\Test</dev:defaultValue>
      </command:parameter>
      <command:parameter required="false" variableLength="true" globbing="false" pipelineInput="False" position="8" aliases="none">
        <maml:name>ThreadCount</maml:name>
        <maml:description>
          <maml:para>Number of asynchronous threads to use</maml:para>
        </maml:description>
        <command:parameterValue required="true" variableLength="false">System.UInt32</command:parameterValue>
        <dev:type>
          <maml:name>System.UInt32</maml:name>
          <maml:uri />
        </dev:type>
        <dev:defaultValue>4</dev:defaultValue>
      </command:parameter>
      <command:parameter required="false" variableLength="true" globbing="false" pipelineInput="False" position="6" aliases="none">
        <maml:name>Title</maml:name>
        <maml:description>
          <maml:para>Title at the top of the HTML report</maml:para>
        </maml:description>
        <command:parameterValue required="true" variableLength="false">System.String</command:parameterValue>
        <dev:type>
          <maml:name>System.String</maml:name>
          <maml:uri />
        </dev:type>
        <dev:defaultValue>Permissions Report</dev:defaultValue>
      </command:parameter>
    </command:parameters>
    <command:inputTypes>
      <command:inputType>
        <dev:type>
          <maml:name>[System.IO.DirectoryInfo[]] TargetPath parameter. Strings can be passed to this parameter and will be auto-cast to DirectoryInfo.</maml:name>
        </dev:type>
        <maml:description>
          <maml:para></maml:para>
        </maml:description>
      </command:inputType>
    </command:inputTypes>
    <command:returnValues>
      <command:returnValue>
        <dev:type>
          <maml:name>[System.String] XML PRTG sensor output</maml:name>
        </dev:type>
        <maml:description>
          <maml:para></maml:para>
        </maml:description>
      </command:returnValue>
    </command:returnValues>
    <maml:alertSet>
      <maml:alert>
        <maml:para>This code has not been reviewed or audited by a third party</maml:para>
        <maml:para>This code has limited or no tests</maml:para>
        <maml:para>It was designed for presenting reports to non-technical management or administrative staff</maml:para>
        <maml:para>It is convenient for that purpose but it is not recommended for compliance reporting or similar formal uses</maml:para>
        <maml:para>ToDo: - Investigate - Are we filtering out ignored domains in 2 places?  redundant?  Why is the IgnoreDomain syntax regex with slashes required? (works but should not be required, that makes no sense) - Investigate - What happens if an ACE contains a SID that is in an object's SID history?</maml:para>
        <maml:para>- Investigate - Combine PsDfs and ConvertTo-DistinguishedName into a native C# module PsWin32Api</maml:para>
        <maml:para>- Consider implementing universally the ADsPath format: WinNT://WORKGROUP/SERVER/USER</maml:para>
        <maml:para>    - WinNT://CONTOSO/Administrator for a domain account on a domain-joined server     - WinNT://CONTOSO/SERVER123/Administrator for a local account on a domain-joined server     - WinNT://WORKGROUP/SERVER123/Administrator for a local account on a workgroup server (not joined to an AD domain) - Bug - Doesn't work for LDAP users' default group/primary group (which is typically Domain Users).     - The user's default group is not listed in their memberOf attribute     - Need to fix the LDAP search filter to include the primary group attribute. - Bug - Now starting to search Owner Access List, some Identityreferences of Owners have O: prefix (O:S-1-5-...) and we're not handling that yet</maml:para>
        <maml:para>- Bug - Expand-IdentityReference should not call Search-Directory when the account name is an unresolved SID</maml:para>
        <maml:para>- Bug - Get-WellKnownSid repeatedly creating CIM sessions to same destination in domain env?</maml:para>
        <maml:para>verify still ongoing.  Add debug output suffix "# For $ComputerName" so debug is easier to read - Bug - For a fake group created by New-FakeDirectoryEntry in the Adsi module, in the report its name will end up as an NT Account (CONTOSO\User123).     - If it is a fake user, its name will correctly appear without the domain prefix (User123) - Bug - Fix bug in PlatyPS New-MarkdownHelp with multi-line param descriptions (?and example help maybe affected also?).     - When provided the same comment-based help as input, Get-Help respects the line breaks but New-MarkdownHelp does not.     - New-MarkdownHelp generates an inaccurate markdown representation by converting multiple lines to a single line.     - Declared as wontfix https://github.com/PowerShell/platyPS/issues/314     - Want to fix it myself and submit a PR     - Until then, workaround is to include markdown syntax in PowerShell comment-based help     - That is why there are so many extra blank lines and unordered lists in the commented metadata in this script - Feature - DNS names should all end in ., NetBIOS names should not.</maml:para>
        <maml:para>- Feature - Use DNS wherever possible.</maml:para>
        <maml:para>Use FQDNs wherever possible.  Except a -NetBIOS switch to use NetBIOS for brevity in HTML? - Feature - Normalize hostname and username capitalization; for example whoami output is all lowercase even if hostname and username are not</maml:para>
        <maml:para>- Feature - [switch]$IncludeOwner parameter to support reporting ACL Owners.</maml:para>
        <maml:para>    - Currently we search folders for non-inherited access rules,     - To those access rules, we add a simulated FullControl access rule for the Owner to show their effective access     - This misses folders with only inherited access rules but a different owner     - Solving this will have a significant performance impact     - Every ACL of every subfolder will have to be retrieved (even if inheritance is enabled and permissions are identical)     - This is why it will be an optional parameter. - Feature - List any excluded accounts at the end</maml:para>
        <maml:para>- Feature - Remove usage of Add-Member to improve performance (create new pscustomobjects instead, nest original object inside)</maml:para>
        <maml:para>- Feature - This script does NOT account for individual file permissions.</maml:para>
        <maml:para>Only folder permissions are considered. - Feature - This script does NOT account for share permissions. Only NTFS permissions are considered. - Feature - Support ACLs from Registry or AD objects</maml:para>
        <maml:para>- Feature - [string[]$Properties parameter to specify properties to include in report</maml:para>
        <maml:para>- Feature - Implement Send-MailKitMessage module</maml:para>
        <maml:para>- Feature - [hashtable]$AdsiCredential parameter, key is Adsi server name, value is PSCredential</maml:para>
        <maml:para>- Feature - [switch]$IncludeGroupChain parameter to retrieve entire group membership chain</maml:para>
        <maml:para>- Feature - [switch]$CacheEntireDirectories parameter to retrieve entire directory of known directories, cache in memory.</maml:para>
        <maml:para>Faster?  Threshold of n identityreferences where it makes sense?  When using option to retrieve entire group tree?</maml:para>
      </maml:alert>
    </maml:alertSet>
    <command:examples>
      <command:example>
        <maml:title>-------------------------- EXAMPLE 1 --------------------------</maml:title>
        <dev:code>Export-Permission.ps1 -TargetPath C:\Test</dev:code>
        <dev:remarks>
          <maml:para>Generate reports on the NTFS permissions for the folder C:\Test and all subfolders</maml:para>
        </dev:remarks>
      </command:example>
      <command:example>
        <maml:title>-------------------------- EXAMPLE 2 --------------------------</maml:title>
        <dev:code>Export-Permission.ps1 -TargetPath C:\Test -ExcludeAccount 'BUILTIN\\Administrator'</dev:code>
        <dev:remarks>
          <maml:para>Generate reports on the NTFS permissions for the folder C:\Test and all subfolders</maml:para>
          <maml:para>Exclude the built-in Administrator account from the HTML report</maml:para>
          <maml:para>The ExcludeAccount parameter uses RegEx, so the \ in BUILTIN\Administrator needed to be escaped.</maml:para>
          <maml:para>The RegEx escape character is \ so that is why the regular expression needed for the parameter is 'BUILTIN\\Administrator'</maml:para>
        </dev:remarks>
      </command:example>
      <command:example>
        <maml:title>-------------------------- EXAMPLE 3 --------------------------</maml:title>
        <dev:code>Export-Permission.ps1 -TargetPath C:\Test -ExcludeAccount @(
    'BUILTIN\\Administrators',
    'BUILTIN\\Administrator',
    'CREATOR OWNER',
    'NT AUTHORITY\\SYSTEM'
)</dev:code>
        <dev:remarks>
          <maml:para>Generate reports on the NTFS permissions for the folder C:\Test and all subfolders</maml:para>
          <maml:para>Exclude from the HTML report: - The built-in Administrator account</maml:para>
          <maml:para>- The built-in Administrators group and its members (unless they appear elsewhere in the permissions)</maml:para>
          <maml:para>- The CREATOR OWNER security principal</maml:para>
          <maml:para>- The computer account (NT AUTHORITY\SYSTEM)</maml:para>
          <maml:para></maml:para>
          <maml:para>Note: CREATOR OWNER will still be reported as an alarm in the PRTG XML output</maml:para>
        </dev:remarks>
      </command:example>
      <command:example>
        <maml:title>-------------------------- EXAMPLE 4 --------------------------</maml:title>
        <dev:code>Export-Permission.ps1 -TargetPath C:\Test -ExcludeEmptyGroups</dev:code>
        <dev:remarks>
          <maml:para>Generate reports on the NTFS permissions for the folder C:\Test and all subfolders</maml:para>
          <maml:para>Exclude empty groups from the HTML report (leaving accounts only)</maml:para>
        </dev:remarks>
      </command:example>
      <command:example>
        <maml:title>-------------------------- EXAMPLE 5 --------------------------</maml:title>
        <dev:code>Export-Permission.ps1 -TargetPath C:\Test -IgnoreDomain 'CONTOSO'</dev:code>
        <dev:remarks>
          <maml:para>Generate reports on the NTFS permissions for the folder C:\Test and all subfolders</maml:para>
          <maml:para>Remove the CONTOSO domain prefix from associated accounts and groups</maml:para>
        </dev:remarks>
      </command:example>
      <command:example>
        <maml:title>-------------------------- EXAMPLE 6 --------------------------</maml:title>
        <dev:code>Export-Permission.ps1 -TargetPath C:\Test -IgnoreDomain 'CONTOSO1','CONTOSO2'</dev:code>
        <dev:remarks>
          <maml:para>Generate reports on the NTFS permissions for the folder C:\Test and all subfolders</maml:para>
          <maml:para>Remove the CONTOSO1\ and CONTOSO2\ domain prefixes from associated accounts and groups</maml:para>
          <maml:para>Across the two domains, accounts with the same samAccountNames will be considered equivalent</maml:para>
          <maml:para>Across the two domains, groups with the same Names will be considered equivalent</maml:para>
        </dev:remarks>
      </command:example>
      <command:example>
        <maml:title>-------------------------- EXAMPLE 7 --------------------------</maml:title>
        <dev:code>Export-Permission.ps1 -TargetPath C:\Test -LogDir C:\Logs</dev:code>
        <dev:remarks>
          <maml:para>Generate reports on the NTFS permissions for the folder C:\Test and all subfolders</maml:para>
          <maml:para>Redirect logs and output files to C:\Logs instead of the default location in AppData</maml:para>
        </dev:remarks>
      </command:example>
      <command:example>
        <maml:title>-------------------------- EXAMPLE 8 --------------------------</maml:title>
        <dev:code>Export-Permission.ps1 -TargetPath C:\Test -LevelsOfSubfolders 0</dev:code>
        <dev:remarks>
          <maml:para>Generate reports on the NTFS permissions for the folder C:\Test only (no subfolders)</maml:para>
        </dev:remarks>
      </command:example>
      <command:example>
        <maml:title>-------------------------- EXAMPLE 9 --------------------------</maml:title>
        <dev:code>Export-Permission.ps1 -TargetPath C:\Test -LevelsOfSubfolders 2</dev:code>
        <dev:remarks>
          <maml:para>Generate reports on the NTFS permissions for the folder C:\Test</maml:para>
          <maml:para>Only include subfolders to a maximum of 2 levels deep (C:\Test\Level1\Level2)</maml:para>
        </dev:remarks>
      </command:example>
      <command:example>
        <maml:title>-------------------------- EXAMPLE 10 --------------------------</maml:title>
        <dev:code>Export-Permission.ps1 -TargetPath C:\Test -Title 'New Custom Report Title'</dev:code>
        <dev:remarks>
          <maml:para>Generate reports on the NTFS permissions for the folder C:\Test and all subfolders</maml:para>
          <maml:para>Change the title of the HTML report to 'New Custom Report Title'</maml:para>
        </dev:remarks>
      </command:example>
      <command:example>
        <maml:title>-------------------------- EXAMPLE 11 --------------------------</maml:title>
        <dev:code>Export-Permission.ps1 -TargetPath '\\ad.contoso.com\DfsNamespace\DfsFolderWithTarget'</dev:code>
        <dev:remarks>
          <maml:para>The target path is a DFS folder with folder targets</maml:para>
          <maml:para>Generate reports on the NTFS permissions for the DFS folder targets associated with this path</maml:para>
        </dev:remarks>
      </command:example>
      <command:example>
        <maml:title>-------------------------- EXAMPLE 12 --------------------------</maml:title>
        <dev:code>Export-Permission.ps1 -TargetPath '\\ad.contoso.com\DfsNamespace\DfsFolderWithoutTarget\DfsSubfolderWithoutTarget\DfsSubfolderWithTarget'</dev:code>
        <dev:remarks>
          <maml:para>The target path is a DFS subfolder with folder targets</maml:para>
          <maml:para>Generate reports on the NTFS permissions for the DFS folder targets associated with this path</maml:para>
        </dev:remarks>
      </command:example>
      <command:example>
        <maml:title>-------------------------- EXAMPLE 13 --------------------------</maml:title>
        <dev:code>Export-Permission.ps1 -TargetPath '\\ad.contoso.com\DfsNamespace\DfsFolderWithoutTarget\DfsSubfolderWithoutTarget\DfsSubfolderWithTarget\Subfolder'</dev:code>
        <dev:remarks>
          <maml:para>The target path is a subfolder of a DFS subfolder with folder targets</maml:para>
          <maml:para>Generate reports on the NTFS permissions for the DFS folder targets associated with this path</maml:para>
        </dev:remarks>
      </command:example>
      <command:example>
        <maml:title>-------------------------- EXAMPLE 14 --------------------------</maml:title>
        <dev:code>Export-Permission.ps1 -TargetPath '\\ad.contoso.com\'</dev:code>
        <dev:remarks>
          <maml:para>This is an edge case that is not currently supported</maml:para>
          <maml:para>The target path is the root of an AD domain</maml:para>
          <maml:para>Generate reports on the NTFS permissions for ? Invalid/fail param validation?</maml:para>
        </dev:remarks>
      </command:example>
      <command:example>
        <maml:title>-------------------------- EXAMPLE 15 --------------------------</maml:title>
        <dev:code>Export-Permission.ps1 -TargetPath '\\computer.ad.contoso.com\'</dev:code>
        <dev:remarks>
          <maml:para>This is an edge case that is not currently supported</maml:para>
          <maml:para>The target path is the root of a server</maml:para>
          <maml:para>Generate reports on the NTFS permissions for ? Invalid/fail param validation?</maml:para>
        </dev:remarks>
      </command:example>
      <command:example>
        <maml:title>-------------------------- EXAMPLE 16 --------------------------</maml:title>
        <dev:code>Export-Permission.ps1 -TargetPath '\\ad.contoso.com\DfsNamespace'</dev:code>
        <dev:remarks>
          <maml:para>This is an edge case that is not currently supported</maml:para>
          <maml:para>The target path is a DFS namespace</maml:para>
          <maml:para>Generate reports on the NTFS permissions for the folder on the DFS namespace server associated with this path</maml:para>
          <maml:para>Add a warning that they are permissions from the DFS namespace server and could be confusing</maml:para>
        </dev:remarks>
      </command:example>
      <command:example>
        <maml:title>-------------------------- EXAMPLE 17 --------------------------</maml:title>
        <dev:code>Export-Permission.ps1 -TargetPath '\\ad.contoso.com\DfsNamespace\DfsFolderWithoutTarget'</dev:code>
        <dev:remarks>
          <maml:para>This is an edge case that is not currently supported.</maml:para>
          <maml:para>The target path is a DFS folder without a folder target</maml:para>
          <maml:para>Generate reports on the NTFS permissions for the folder on the DFS namespace server associated with this path</maml:para>
          <maml:para>Add a warning that they are permissions from the DFS namespace server and could be confusing</maml:para>
        </dev:remarks>
      </command:example>
      <command:example>
        <maml:title>-------------------------- EXAMPLE 18 --------------------------</maml:title>
        <dev:code>Export-Permission.ps1 -TargetPath '\\ad.contoso.com\DfsNamespace\DfsFolderWithoutTarget\DfsSubfolderWithoutTarget'</dev:code>
        <dev:remarks>
          <maml:para>This is an edge case that is not currently supported.</maml:para>
          <maml:para>The target path is a DFS subfolder without a folder target.</maml:para>
          <maml:para>Generate reports on the NTFS permissions for the folder on the DFS namespace server associated with this path</maml:para>
          <maml:para>Add a warning that they are permissions from the DFS namespace server and could be confusing</maml:para>
        </dev:remarks>
      </command:example>
    </command:examples>
    <command:relatedLinks />
  </command:command>
</helpItems>